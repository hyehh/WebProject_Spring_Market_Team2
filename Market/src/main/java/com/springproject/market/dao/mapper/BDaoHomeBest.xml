<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.springproject.market.dao.BDaoHomeBest">
	<select id="kitchen" resultType="com.springproject.market.dto.BDtoBest">
		SELECT P.PCODE, SUM(B.BQUANTITY), P.PNAME, P.PPRICEDC, 100-P.PPRICEDC/P.PPRICE*100, P.PFILEPATH FROM BNS AS B, PRODUCT AS P WHERE B.PRODUCT_PCODE=P.PCODE AND P.PCATEGORY='주방용품' AND P.PDELETEDATE IS NULL AND B.BBUYCANCELDATE IS NULL GROUP BY B.PRODUCT_PCODE ORDER BY SUM(B.BQUANTITY) DESC LIMIT 4
	</select>
	
	<select id="washing" resultType="com.springproject.market.dto.BDtoBest">
		SELECT P.PCODE, SUM(B.BQUANTITY), P.PNAME, P.PPRICEDC, 100-P.PPRICEDC/P.PPRICE*100, P.PFILEPATH FROM BNS AS B, PRODUCT AS P WHERE B.PRODUCT_PCODE=P.PCODE AND P.PCATEGORY='세탁용품' AND P.PDELETEDATE IS NULL AND B.BBUYCANCELDATE IS NULL GROUP BY B.PRODUCT_PCODE ORDER BY SUM(B.BQUANTITY) DESC LIMIT 4
	</select>
	
	<select id="cleaning" resultType="com.springproject.market.dto.BDtoBest">
		SELECT P.PCODE, SUM(B.BQUANTITY), P.PNAME, P.PPRICEDC, 100-P.PPRICEDC/P.PPRICE*100, P.PFILEPATH FROM BNS AS B, PRODUCT AS P WHERE B.PRODUCT_PCODE=P.PCODE AND P.PCATEGORY='청소용품' AND P.PDELETEDATE IS NULL AND B.BBUYCANCELDATE IS NULL GROUP BY B.PRODUCT_PCODE ORDER BY SUM(B.BQUANTITY) DESC LIMIT 4
	</select>
	
	<select id="interior" resultType="com.springproject.market.dto.BDtoBest">
		SELECT P.PCODE, SUM(B.BQUANTITY), P.PNAME, P.PPRICEDC, 100-P.PPRICEDC/P.PPRICE*100, P.PFILEPATH FROM BNS AS B, PRODUCT AS P WHERE B.PRODUCT_PCODE=P.PCODE AND P.PCATEGORY='인테리어소품' AND P.PDELETEDATE IS NULL AND B.BBUYCANCELDATE IS NULL GROUP BY B.PRODUCT_PCODE ORDER BY SUM(B.BQUANTITY) DESC LIMIT 4
	</select>
	
	<select id="can" resultType="com.springproject.market.dto.BDtoBest">
		SELECT P.PCODE, SUM(B.BQUANTITY), P.PNAME, P.PPRICEDC, 100-P.PPRICEDC/P.PPRICE*100, P.PFILEPATH FROM BNS AS B, PRODUCT AS P WHERE B.PRODUCT_PCODE=P.PCODE AND P.PCATEGORY='통조림' AND P.PDELETEDATE IS NULL AND B.BBUYCANCELDATE IS NULL GROUP BY B.PRODUCT_PCODE ORDER BY SUM(B.BQUANTITY) DESC LIMIT 4
	</select>
	
	<select id="frozen" resultType="com.springproject.market.dto.BDtoBest">
		SELECT P.PCODE, SUM(B.BQUANTITY), P.PNAME, P.PPRICEDC, 100-P.PPRICEDC/P.PPRICE*100, P.PFILEPATH FROM BNS AS B, PRODUCT AS P WHERE B.PRODUCT_PCODE=P.PCODE AND P.PCATEGORY='냉동식품' AND P.PDELETEDATE IS NULL AND B.BBUYCANCELDATE IS NULL GROUP BY B.PRODUCT_PCODE ORDER BY SUM(B.BQUANTITY) DESC LIMIT 4
	</select>
	
	<select id="beverage" resultType="com.springproject.market.dto.BDtoBest">
		SELECT P.PCODE, SUM(B.BQUANTITY), P.PNAME, P.PPRICEDC, 100-P.PPRICEDC/P.PPRICE*100, P.PFILEPATH FROM BNS AS B, PRODUCT AS P WHERE B.PRODUCT_PCODE=P.PCODE AND P.PCATEGORY='식음료' AND P.PDELETEDATE IS NULL AND B.BBUYCANCELDATE IS NULL GROUP BY B.PRODUCT_PCODE ORDER BY SUM(B.BQUANTITY) DESC LIMIT 4
	</select>
	

</mapper>